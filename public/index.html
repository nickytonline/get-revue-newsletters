<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Download your Revue Newsletters</title>
    <style>
      body {
        --main-color: #000;
        --main-bg-color: #fff;
        --accent-color: blue;

        --padding: 0.5rem;
        --border-radius: 0.25rem;
        display: grid;
        place-items: center;
        font-family: "Comic Sans MS", system-ui, -apple-system,
          BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell,
          "Open Sans", "Helvetica Neue", sans-serif;
        font-size: clamp(1rem, 2vw, 2rem);
        color: var(--main-color);
        background-color: var(--main-bg-color);
        margin: 1.5rem;
        padding: 0;
      }

      @media (prefers-color-scheme: dark) {
        [for="theme-toggle"] {
          display: none;
        }

        body {
          --main-color: #fff;
          --main-bg-color: #000;
          --accent-color: goldenrod;
        }
      }

      @media (prefers-color-scheme: light) {
        [for="theme-toggle"] {
          display: none;
        }
      }

      body:has(#theme-toggle:checked) {
        --main-color: #fff;
        --main-bg-color: #000;
        --accent-color: goldenrod;
      }

      * + * {
        margin-top: 1rem;
      }

      main {
        display: flex;
        flex-direction: column;
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
      }

      a {
        color: var(--accent-color);
      }

      input {
        font-size: inherit;
        padding: var(--padding);
        border-radius: var(--border-radius);
      }

      button {
        font-size: inherit;
        padding: var(--padding);
        border-radius: var(--border-radius);
      }

      [aria-label="footer-navigation"] ul {
        display: flex;
        flex-direction: column;
        align-items: center;
        list-style: none;
        font-size: 75%;
      }

      [for="theme-toggle"] {
        align-self: flex-start;
      }

      [for="theme-toggle"]::before {
        font-size: 150%;
      }

      [for="theme-toggle"]:has(#theme-toggle:checked)::before {
        content: "‚òÄÔ∏è";
      }

      [for="theme-toggle"]:not(:has(#theme-toggle:checked))::before {
        content: "üåô";
      }

      #theme-toggle:checked + [role="status"] #light-mode-status {
        display: none;
      }

      #theme-toggle:not(:checked) + [role="status"] #dark-mode-status {
        display: none;
      }

      .visually-hidden {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
    </style>
  </head>
  <body>
    <main>
      <header>
        <h1>Download your Revue Newsletters</h1>
        <label for="theme-toggle"
          ><span class="visually-hidden">Toggle Theme</span>
          <input type="checkbox" class="visually-hidden" id="theme-toggle" />
          <div role="status" class="visually-hidden">
            The theme has been set to <span id="light-mode-status">light</span
            ><span id="dark-mode-status">dark</span>
          </div>
        </label>
      </header>
      <p>
        This is a simple app that allows you to download your Revue newsletters
        as JSON.
      </p>
      <ul>
        <li>
          You need a Revue API key. To get one, go to
          <a
            href="https://www.getrevue.co/app/integrations"
            target="_blank"
            rel="noopener"
            title="Revue integrations page"
            >https://www.getrevue.co/app/integrations</a
          >
          and request one. It should be at the bottom of the page. It takes
          around 24 hours to get your API key.
        </li>
        <li>Enter your API key below and click "Download".</li>
        <li>
          If for some reason this isn't working for you, you can also
          <a href="https://github.com/nickytonline/get-revue-newsletters"
            >grab the project locally</a
          >, or run the
          <a
            href="https://gist.github.com/nickytonline/102bb45e625db6b9ae0157e293cfb0a3"
            >script in this gist locally</a
          >.
        </li>
      </ul>
      <form
        name="revue"
        method="post"
        action="/.netlify/functions/get-newsletters"
      >
        <label for="revue-api-key">Revue API Key</label>
        <input type="text" name="revue-api-key" id="revue-api-key" required />
        <button type="submit">Download</button>
      </form>
      <output id="submitting"> </output>
    </main>
    <footer
      role="contentinfo"
      class="[ site-foot ] [ pad-top-700 pad-bottom-900 ]"
    >
      <nav aria-label="footer-navigation">
        <ul class>
          <li>
            <a href="https://www.netlify.com" class="netlify-footer">
              <img
                src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg"
                alt="Deploys by Netlify"
              />
            </a>
          </li>
          <li>
            <a href="https://github.com/nickytonline/get-revue-newsletters"
              >project on GitHub</a
            >
          </li>
          <li>
            <a href="https://iamdeveloper.com">iamdeveloper.com</a>
          </li>
        </ul>
      </nav>
      <script>
        document.forms["revue"].addEventListener("submit", function (e) {
          document.getElementById("submitting").innerHTML =
            "Submitting. This might take a few seconds...";
        });
      </script>
    </footer>
  </body>
</html>
